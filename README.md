# Marmoset Detection with YOLOv8 and SAM

## Introduction

This project demonstrates the process of detecting marmosets in images to detect and segment objects by using YOLOv8 for bounding box detection and Segment Anything Model (SAM) for segmentation.

### Authors:
- 6402001: Gunn Kittichaidamrong
- 6402006: Natchanon Traetulakarn
- 6402009: Prawee Sinweeruthai
- 6402016: Withinat Teewiriya

## Steps 

### 1. Import Dataset

Prepare a dataset containing images of marmosets
The path to the data that will use to train the model ("train") is `/content/marmoset/marmoset-dlc-2021-05-07/labeled-data/reachingvideo1`.

The path to the data that will use to validate the model ("val") is `/content/marmoset/marmoset-dlc-2021-05-07/labeled-data/refinement1`.

### 2. Convert Data into YOLO-Compatible Form

Convert the dataset annotations into YOLO format using deeplabcut2yolo. This uses the .json annotation file and .csv and the converted compatible format is saved in `save` path.


### 3. Create YAML File

Create a `output.yaml` file that defines the dataset structure for YOLOv8 training. The file includes paths to the training and validation datasets, and the number of classes and their names is specified (we use 2 classes : B, W)

### 4. Import and Train YOLO Model

Use the YOLOv8 model from the Ultralytics library for training.

### 5. Import Test Dataset

Import a test dataset to evaluate the YOLOv8 model by using !wget and !unzip on the test DLC link.

### 6. Import SAM Model

Import the Segment Anything Model (SAM) to perform segmentation based on bounding box detections from YOLOv8. 
We used sam_b.pt.

### 7. Use SAM Model to Segment Data

The bounding boxes (bboxes) obtained from YOLOv8 is then used in the SAM model for segmentation.
The "for" loop in the script loops through all the images in the testing dataset and detects marmosets with YOLOv8. The bboxes to generate masks with SAM, and saves the output images with segmentation to `output_path`.

### Requirements
To run this project the following resourches are needed:

Python 3.8+
PyTorch
OpenCV
Ultralytics YOLOv8
Segment Anything Model (SAM)
Jupyter Notebook or Google Colab

### Results
The results will include both bounding box detections from YOLOv8 and precise segmentation masks generated by SAM, which can be visualized to evaluate the models' performance on the marmoset dataset.

### Acknowledgments
- Ultralytics for providing the YOLOv8 model.
- Sira for illustrating the use of deepcut2yolo.
- P'Swiss for illustrating how to download and unzip files using Linux wget commands.
- Aj.Titipat for the instructions and lectures.

Gunn, Natchanon, Prawee, Withinat
EGBE/M 2024
